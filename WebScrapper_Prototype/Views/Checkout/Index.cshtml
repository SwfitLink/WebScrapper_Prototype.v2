@using Microsoft.AspNetCore.Identity;
@using WebScrapper_Prototype.Areas.Identity.Data;
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@model WebScrapper_Prototype.Models.CheckoutAccount
@{
	ViewData["Title"] = "Checkout";
}
<!DOCTYPE html>
<html lang="zxx">
<head>
	<!-- Title Tag  -->
	<title>Checkout</title>
	<!-- Meta Tag -->
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name='copyright' content=''>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- Favicon -->
	<link rel="icon" type="image/png" href="#">
	<!-- Web Font -->
	<link href="https://fonts.googleapis.com/css?family=Lato:200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&display=swap" rel="stylesheet">
	<!-- StyleSheet -->
	<!-- Bootstrap -->
	<link rel="stylesheet" href="~/css/bootstrap.css">
	<!-- Magnific Popup -->
	<link rel="stylesheet" href="~/css/magnific-popup.min.css">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="~/css/font-awesome.css">
	<!-- Fancybox -->
	<link rel="stylesheet" href="~/css/jquery.fancybox.min.css">
	<!-- Themify Icons -->
	<link rel="stylesheet" href="~/css/themify-icons.css">
	<!-- Jquery Ui -->
	<link rel="stylesheet" href="~/css/jquery-ui.css">
	<!-- Nice Select CSS -->
	<link rel="stylesheet" href="~/css/niceselect.css">
	<!-- Animate CSS -->
	<link rel="stylesheet" href="~/css/animate.css">
	<!-- Flex Slider CSS -->
	<link rel="stylesheet" href="~/css/flex-slider.min.css">
	<!-- Owl Carousel -->
	<link rel="stylesheet" href="~/css/owl-carousel.css">
	<!-- Slicknav -->
	<link rel="stylesheet" href="~/css/slicknav.min.css">
	<!-- Alertify -->
	<link rel="stylesheet" href="~/alertifyjs/css/alertify.min.css" />
	<link rel="stylesheet" href="~/alertifyjs/css/themes/default.min.css" />
	<!-- Reset CSS -->
	<link rel="stylesheet" href="~/css/reset.css">
	<!-- Nice Select JS -->
	<link rel="stylesheet" href="~/css/niceselect.css">
	<!-- Temp CSS -->
	<link rel="stylesheet" href="~/css/style.css">
	<!-- Responsive CSS -->
	<link rel="stylesheet" href="~/css/responsive.css">
	<!-- Site CSS -->
	<link rel="stylesheet" href="~/css/site.css">
</head>
<body class="js">
	<div id="progressBarContainer">
		<div id="progressBar"></div>
	</div>
	<!-- Preloader -->
	<div class="preloader">
		<div class="preloader-inner">
			<div class="preloader-icon">
				<span></span>
				<span></span>
			</div>
		</div>
	</div>
	<!-- End Preloader -->
	<!-- End Scroll -->
	<div id="progressBarContainer">
		<div id="progressBar"></div>
	</div>
	<!-- End Scroll -->
	<div class="header shop">
		<!-- Topbar -->
		<partial name="_topbar" />
		<!-- End Topbar -->
		<!-- Header Inner -->
		<div class="header-inner">
			<div class="container">
				<div class="cat-nav-head">
					<div class="row">
						<div class="col-12">
							<div id="shopmenu" class="menu-area">
								<!-- Main Menu -->
								<nav class="navbar navbar-expand-lg">
									<div class="navbar-collapse">
										<div class="nav-inner">
											<ul class="nav main-menu menu navbar-nav">
												<li class="active">
													<a href="/Shop">Shop<i class="ti-angle-down"></i></a>
													<ul class="dropdown">
														<li><a href="/Cart">Shop</a></li>
														<li><a href="/Cart">View Cart</a></li>
													</ul>
												<li><a href="/Home/UnderConstruction">Contact Us</a></li>
											</ul>
										</div>
									</div>
								</nav>
								<!--/ End Main Menu -->
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--/ End Header Inner -->
	</div>
	<!--/ End Header -->
	<!-- Breadcrumbs -->
	<div class="breadcrumbs">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<div class="bread-inner">
						<ul class="bread-list">
							<li><a href="/Shop/Cart">Cart<i class="ti-arrow-right"></i></a></li>
							<li class="active"><a href="/Checkout">Checkout</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- End Breadcrumbs -->
	<!-- Start Checkout -->
	<div id="loading-bar" style="display: none;">
		<section class="shop checkout section">
			<h4>Please wait while we process your order...</h4>
		</section>
	</div>
	<section id="123Section" class="shop checkout section">
		<div class="container">
			<div class="col-md-12 col-md-8 col-12">
			<div class="row">
				@if (ViewBag.userIsCookie)
				{
					<div class="col-lg-8 col-12">
						<div class="checkout-form">
							<h2>Make Your Checkout Here</h2>
							<p>Please register in order to checkout more quickly</p>
							<!-- Form -->
							<form id="registerForm" asp-action="CheckoutAccount" class="form" method="post">
								<div asp-validation-summary="ModelOnly" class="text-danger"></div>
								<div class="row">
									<div class="col-lg-6 col-md-6 col-12">
										<div class="form-group">
											<label>First Name<span>*</span></label>
											<input asp-for="FirstName" type="text" name="firstName" autocomplete="firstname" placeholder="" required="required">
										</div>
									</div>
									<div class="col-lg-6 col-md-6 col-12">
										<div class="form-group">
											<label>Last Name<span>*</span></label>
											<input asp-for="LastName" type="text" name="lastName" autocomplete="lastname" placeholder="" required="required">
										</div>
									</div>
									<div class="col-lg-6 col-md-6 col-12">
										<div class="form-group">
											<label>Email Address<span>*</span></label>
											<input asp-for="ContactEmail" type="email" name="contactEmail" autocomplete="email" placeholder="" required="required">
										</div>
									</div>
									<div class="col-lg-6 col-md-6 col-12">
										<div class="form-group">
											<label>Phone Number<span>*</span></label>
											<input asp-for="PhoneNumber" type="number" name="phoneNumber" autocomplete="cellphone" placeholder="" required="required">
										</div>
									</div>
									<div class="col-lg-6 col-md-6 col-12">
										<div class="form-group">
											<label>Country<span>*</span></label>
											<select name="countryCode" asp-for="CountryCode" id="locationCountry">
												<option value="ZA">South Africa</option>
												<option value="CH">Switzerland</option>
											</select>
										</div>
									</div>
									<div class="col-lg-6 col-md-6 col-12">
										<div class="form-group">
											<label>Province<span>*</span></label>
											<select name="locationProvince" asp-for="LocationProvince" id="locationProvince">
												<option value="Western Cape" selected="selected">Western Cape</option>
												<option value="Eastern Cape">Eastern Cape</option>
												<option value="Gauteng">Gauteng</option>
											</select>
										</div>
									</div>
									<div class="col-lg-6 col-md-6 col-12">
										<div class="form-group">
											<label>City<span>*</span></label>
											<select name="locationCity" asp-for="LocationCity" id="locationCountry">
												<option value="ZA">Cape Town (CPT)</option>
												<option value="CH">Port Elizabeth (PE)</option>
											</select>
										</div>
									</div>
									<div class="col-lg-6 col-md-6 col-12">
										<div class="form-group">
											<label>Address Line 1<span>*</span></label>
											<input asp-for="AddressLine1" type="text" name="addressLine1" autocomplete="addressline1" placeholder="" required="required">
										</div>
									</div>
									<div class="col-lg-6 col-md-6 col-12">
										<div class="form-group">
											<label>Address Line 2<span>*</span></label>
											<input asp-for="AddressLine2" type="text" name="addressLine2" autocomplete="addressline2" placeholder="" required="required">
										</div>
									</div>
									<div class="col-lg-6 col-md-6 col-12">
										<div class="form-group">
											<label>Postal Code<span>*</span></label>
											<input asp-for="PostalCode" type="text" name="postalCode" autocomplete="postalcode" placeholder="" required="required">
										</div>
									</div>
									<div class="col-lg-6 col-md-6 col-12">
										<div class="form-group create-account">
											<input asp-for="IsSubscribed" name="isSubscribed" id="cbox" type="checkbox">
											<label>Subscribe to Newsletter?</label>
										</div>
									</div>
									<div class="col-12">
										<input type="submit" value="Submit Details" class="btn btn-primary" />
									</div>
								</div>
							</form>
							<!--/ End Form -->
						</div>
					</div>
				}
				else
					{
						<div class="col-lg-6 col-md-6 col-12">
							<div class="order-details">
								<!-- Order Widget -->
								<div class="single-widget">
									<h2>Verify Account Details</h2>
									<div class="content">
										<ul>
											<li>
												First Name:
												<span class="total-amount">@Model.FirstName</span>
											</li>
											<li>
												LastName:
												<span class="total-amount">@Model.LastName</span>
											</li>
											<li>
												Contact Email:
												<span class="total-amount">@Model.ContactEmail</span>
											</li>
											<li>
												Cellphone Number:
												<span class="total-amount">@Model.PhoneNumber</span>
											</li>
											<li class="last">
												Shipping Address:
												<span class="total-amount">@Model.AddressLine1</span><br>
												<span class="total-amount">@Model.AddressLine2</span><br>
												<span class="total-amount">@Model.LocationCity</span><br>
												<span class="total-amount">@Model.LocationProvince</span><br>
												<span class="total-amount">@Model.PostalCode</span><br>
											</li>
										</ul>
									</div>
								</div>
								<!--/ End Order Widget -->
								<!-- Button Widget -->
								<div class="single-widget get-button">
									<div class="content">
										<div class="button">
											<a href="#" onclick="editDetails()" class="btn disabled">Edit Details</a>
										</div>
									</div>
								</div>
								<!--/ End Button Widget -->
							</div>
						</div>
						<div class="col-lg-6 col-md-6 col-12">
							<div class="order-details">
								<!-- Order Widget -->
								<div class="single-widget">
									<h2>Order Summary</h2>
									<div class="content">
										<ul>
											<li>
												Total Items:
												<span class="total-amount" style="font-weight:600;">@ViewBag.BasketCount</span>
											</li>
											<li>
												Before Discount:
												<span class="total-amount" style="text-decoration-line:line-through; color:red;">R @ViewBag.CartTotalBase.ToString("#,##0.00")</span>
											</li>
											<li>
												You Save:
												<span class="total-amount" style="color:forestgreen;font-weight:800;">R @ViewBag.Savings.ToString("#,##0.00")</span>
											</li>
											<li>
												Sub Total:
												<span class="total-amount" style="font-weight:600;">R @ViewBag.CartTotalSale.ToString("#,##0.00")</span>
											</li>
											<li>
												Shipping:
												@if (ViewBag.GetFreeShipping > 0)
												{
													<label>Spend R <span style="text-decoration-line:underline;">@ViewBag.GetFreeShipping</span> to get <b>FREE</b> Shipping</label>
												}
												else
												{
													<span><b>FREE</b></span>

												}
											</li>
											<li style="color:gray;">
												Handling Fee <i class="fa fa-info-circle" style="white-space: nowrap;" data-toggle="tooltip" data-placement="right" title="Think of our handling fee like a secret seasoning - it's the special ingredient that adds value to your shopping experience and helps us continue providing top-notch service without sacrificing our bottom line."></i> :
												<span style="color:gray;">R @ViewBag.HandlingFee</span>
											</li>
											<li class="last">Total: <span style="text-decoration-line:underline;font-weight:700;">R @ViewBag.GrandTotal.ToString("#,##0.00")</span></li>
										</ul>
									</div>
									<script>
										$(function () {
											$('[data-toggle="tooltip"]').tooltip()
										})
									</script>
								</div>
								<!--/ End Order Widget -->	
							</div>
						</div>
						<h2 id="makepayment">Select Payment Method Below:</h2>
						<div class="col-lg-12 col-md-6 col-12">
							<div class="order-details">
								<!-- Order Widget -->
								<div class="single-widget">
									<h2 id="makepayment">Payment Methods</h2>
									<div class="content">
										<ul class="check-box-list">
											<li>
												<label class="checkbox-inline" for="0"><input name="EFT" id="0" type="checkbox"> EFT</label>
											</li>
											<li>
												<label class="checkbox-inline" for="1"><input name="PayPal" id="1" type="checkbox"> PayPal</label>
											</li>
											<li>
												<label class="checkbox-inline" for="2"><input name="CreditCard" id="2" type="checkbox"> Credit Card</label>
											</li>
											<li>
												<label class="checkbox-inline" for="3"><input name="PayFast" id="3" type="checkbox"> PayFast</label>
											</li>
										</ul>
									</div>
								</div>
								<!--/ End Order Widget -->
								<!-- Button Widget -->
								<div class="single-widget get-button">
									<div class="content">
										<div class="button">
											<a href="#" onclick="proceedToCheckout()" class="btn">Proceed with payment</a>
										</div>
									</div>
								</div>
								<!--/ End Button Widget -->
							</div>
						</div>
					}
			</div>
			</div>
		</div>
	</section>
	<!--/ End Checkout -->
	<section class="shop-services section home">
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6 col-12">
					<!-- Start Single Service -->
					<div class="single-service">
						<i class="ti-rocket"></i>
						<h4>Free shipping</h4>
						<p>Orders over R1500</p>
					</div>
					<!-- End Single Service -->
				</div>
				<div class="col-lg-3 col-md-6 col-12">
					<!-- Start Single Service -->
					<div class="single-service">
						<i class="ti-reload"></i>
						<h4>Warranty Included</h4>
						<p>Up to 2 years</p>
					</div>
					<!-- End Single Service -->
				</div>
				<div class="col-lg-3 col-md-6 col-12">
					<!-- Start Single Service -->
					<div class="single-service">
						<i class="ti-lock"></i>
						<h4>Secure Payment</h4>
						<p>100% secure payment</p>
					</div>
					<!-- End Single Service -->
				</div>
				<div class="col-lg-3 col-md-6 col-12">
					<!-- Start Single Service -->
					<div class="single-service">
						<i class="ti-tag"></i>
						<h4>Best Price</h4>
						<p>Everything is <span>On Sale</span> 24/7 </p>
					</div>
					<!-- End Single Service -->
				</div>
			</div>
		</div>
	</section>
	<!-- Start Shop Newsletter  -->
	<section class="shop-newsletter section">
		<div class="container">
			<div class="inner-top">
				<div class="row">
					<div class="col-lg-8 offset-lg-2 col-12">
						<!-- Start Newsletter Inner -->
						<div class="inner">
							<h4>Newsletter</h4>
							<p> Subscribe to our newsletter and get <span>10%</span> off your first purchase</p>
							<form action="mail/mail.php" method="get" target="_blank" class="newsletter-inner">
								<input name="EMAIL" placeholder="Your email address" required="" type="email">
								<button class="btn">Subscribe</button>
							</form>
						</div>
						<!-- End Newsletter Inner -->
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- End Shop Newsletter -->
	<!-- Start Footer Area -->
	<footer class="footer">
		<!-- Footer Top -->
		<div class="footer-top section">
			<div class="container">
				<div class="row">
					<div class="col-lg-5 col-md-6 col-12">
						<!-- Single Widget -->
						<div class="single-footer about">
							<div class="logo">
								<a href="/"><img src="images/logo2.png" alt="#"></a>
							</div>
							<p class="text">Praesent dapibus, neque id cursus ucibus, tortor neque egestas augue,  magna eros eu erat. Aliquam erat volutpat. Nam dui mi, tincidunt quis, accumsan porttitor, facilisis luctus, metus.</p>
							<p class="call">Got Question? Call us 24/7<span><a href="tel:123456789">+27 81 565 0206</a></span></p>
						</div>
						<!-- End Single Widget -->
					</div>
					<div class="col-lg-2 col-md-6 col-12">
						<!-- Single Widget -->
						<div class="single-footer links">
							<h4>Information</h4>
							<ul>
								<li><a href="/Home/UnderConstruction">About Us</a></li>
								<li><a href="/Home/UnderConstruction">Faq</a></li>
								<li><a href="/Home/UnderConstruction">Terms & Conditions</a></li>
								<li><a href="/Home/UnderConstruction">Contact Us</a></li>
								<li><a href="/Home/UnderConstruction">Help</a></li>
							</ul>
						</div>
						<!-- End Single Widget -->
					</div>
					<div class="col-lg-2 col-md-6 col-12">
						<!-- Single Widget -->
						<div class="single-footer links">
							<h4>Customer Service</h4>
							<ul>
								<li><a href="/Home/UnderConstruction">Payment Methods</a></li>
								<li><a href="/Home/UnderConstruction">Money-back</a></li>
								<li><a href="/Home/UnderConstruction">Returns</a></li>
								<li><a href="/Home/UnderConstruction">Shipping</a></li>
								<li><a href="/Home/UnderConstruction">Privacy Policy</a></li>
							</ul>
						</div>
						<!-- End Single Widget -->
					</div>
					<div class="col-lg-3 col-md-6 col-12">
						<!-- Single Widget -->
						<div class="single-footer social">
							<h4>Get In Touch</h4>
							<!-- Single Widget -->
							<div class="contact">
								<ul>
									<li>Montague Gardens Cape Town</li>
									<li>8001 South Africa.</li>
									<li>info@swfitlink.com</li>
									<li>+27 81 565 0206</li>
								</ul>
							</div>
							<!-- End Single Widget -->
							<ul>
								<li><a href="#"><i class="ti-facebook"></i></a></li>
								<li><a href="#"><i class="ti-twitter"></i></a></li>
								<li><a href="#"><i class="ti-flickr"></i></a></li>
								<li><a href="#"><i class="ti-instagram"></i></a></li>
							</ul>
						</div>
						<!-- End Single Widget -->
					</div>
				</div>
			</div>
		</div>
		<!-- End Footer Top -->
		<div class="copyright">
			<div class="container">
				<div class="inner">
					<div class="row">
						<div class="col-lg-6 col-12">
							<div class="left">
								<p>Copyright © 2023 <a href="/" target="_blank">SwiftLink</a>  -  All Rights Reserved.</p>
							</div>
						</div>
						<div class="col-lg-6 col-12">
							<div class="right">
								<img src="images/payments.png" alt="#">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</footer>
	<!-- /End Footer Area -->
	@section Scripts {
		<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
	}
	<!-- Jquery -->
	<script src="~/js/jquery.min.js"></script>
	<script src="~/js/jquery-migrate-3.0.0.js"></script>
	<script src="~/s/jquery-ui.min.js"></script>
	<!-- Popper JS -->
	<script src="~/js/popper.min.js"></script>
	<!-- Bootstrap JS -->
	<script src="~/js/bootstrap.min.js"></script>
	<!-- Color JS -->
	<script src="~/js/colors.js"></script>
	<!-- Slicknav JS -->
	<script src="~/js/slicknav.min.js"></script>
	<!-- Owl Carousel JS -->
	<script src="~/js/owl-carousel.js"></script>
	<!-- Magnific Popup JS -->
	<script src="~/js/magnific-popup.js"></script>
	<!-- Waypoints JS -->
	<script src="~/js/waypoints.min.js"></script>
	<!-- Countdown JS -->
	<script src="~/js/finalcountdown.min.js"></script>
	<!-- Nice Select JS -->
	<script src="~/js/nicesellect.js"></script>
	<!-- Flex Slider JS -->
	<script src="~/js/flex-slider.js"></script>
	<!-- Alertify -->
	<script src="~/alertifyjs/alertify.min.js"></script>
	<!-- ScrollUp JS -->
	<script src="~/js/scrollup.js"></script>
	<!-- Onepage Nav JS -->
	<script src="~/js/onepage-nav.min.js"></script>
	<!-- Easing JS -->
	<script src="~/js/easing.js"></script>
	<!-- Active JS -->
	<script src="~/js/active.js"></script>

	<!-- Custom Scripts -->
	<!--Load Scrolling Bar-->
	<script type="text/javascript">
		const progressBarContainer = document.querySelector("#progressBarContainer");
		const progressBar = document.querySelector("#progressBar");
		let totalPageHeight = document.body.scrollHeight - window.innerHeight;
		let debounceResize;

		window.addEventListener("scroll", () => {
			let newProgressHeight = window.pageYOffset / totalPageHeight;
			progressBar.style.transform = `scale(1,${newProgressHeight})`;
			progressBar.style.opacity = `${newProgressHeight}`;
		}, {
			capture: true,
			passive: true
		});

		window.addEventListener("resize", () => {
			clearTimeout(debounceResize);
			debounceResize = setTimeout(() => {
				totalPageHeight = document.body.scrollHeight - window.innerHeight;
			}, 250);
		});

		progressBarContainer.addEventListener("click", (e) => {
			let newPageScroll = e.clientY / progressBarContainer.offsetHeight * totalPageHeight;
			window.scrollTo({
				top: newPageScroll,
				behavior: 'smooth'
			});
		});
	</script>
	<!--Functions-->
	<script type="text/javascript">
		// Hide the loading bar on page load
		$(document).ready(function () {
			$('#loading-bar').hide();
			$('#123Section').show();
		});

		// [GET]
		// Proceed to checkout
		function proceedToCheckout() {
			let startPlaceOrder = 1;
			// Show the loading bar
			$('#loading-bar').show();
			$('#123Section').hide();
			// Make an Ajax call to the server to start the processing
			$.ajax({
				type: "GET",
				url: '/Checkout/Index',
				data: { startPlaceOrder: startPlaceOrder },
				success: function (r) {
					alertify.notify('Order Created!', 'success', 2, function () { console.log('dismissed'); });
					// Hide the loading bar when the processing is complete
					$('#loading-bar').hide();

					// Do something with the server response, if necessary
					alert('Thank You. Your Order has been placed. Please check your email!');
					window.location.href = '/Orders/Index';
				},
				error: function (e) {
					alertify.error('Error: JavaScript Function (proceedToCheckout)');
					alertify.error(e);
				}
			});
		}
	</script>
</body>

</html>